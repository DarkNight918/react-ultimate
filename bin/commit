#!/bin/sh
# We should run tests against commited state, not working dir state
# So we stash / unstash non-staged changes
# git commit / push invoke git hooks and npm test via husky

git stash save --keep-index

if gulp dist; then
  if git commit $@; then
    git push
  fi
fi

git stash apply
